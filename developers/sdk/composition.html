<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Calling other Applications</title>


        <!-- Custom HTML head -->

        <meta name="description" content="The Linera Developer Manual">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/theme.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">The Linera Manual</a></li><li class="chapter-item expanded "><a href="developers.html"><strong aria-hidden="true">1.</strong> Developers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="developers/getting_started.html"><strong aria-hidden="true">1.1.</strong> Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="developers/getting_started/installation.html"><strong aria-hidden="true">1.1.1.</strong> Installation</a></li><li class="chapter-item "><a href="developers/getting_started/hello_linera.html"><strong aria-hidden="true">1.1.2.</strong> Hello, Linera</a></li></ol></li><li class="chapter-item "><a href="developers/core_concepts.html"><strong aria-hidden="true">1.2.</strong> The Linera Protocol</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="developers/core_concepts/overview.html"><strong aria-hidden="true">1.2.1.</strong> Overview</a></li><li class="chapter-item "><a href="developers/core_concepts/microchains.html"><strong aria-hidden="true">1.2.2.</strong> Microchains</a></li><li class="chapter-item "><a href="developers/core_concepts/wallets.html"><strong aria-hidden="true">1.2.3.</strong> Wallets</a></li><li class="chapter-item "><a href="developers/core_concepts/node_service.html"><strong aria-hidden="true">1.2.4.</strong> Node Service</a></li><li class="chapter-item "><a href="developers/core_concepts/applications.html"><strong aria-hidden="true">1.2.5.</strong> Applications</a></li></ol></li><li class="chapter-item "><a href="developers/sdk.html"><strong aria-hidden="true">1.3.</strong> Writing Linera Applications</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="developers/sdk/creating_a_project.html"><strong aria-hidden="true">1.3.1.</strong> Creating a Project</a></li><li class="chapter-item "><a href="developers/sdk/state.html"><strong aria-hidden="true">1.3.2.</strong> Creating the Application State</a></li><li class="chapter-item "><a href="developers/sdk/abi.html"><strong aria-hidden="true">1.3.3.</strong> Defining the ABI</a></li><li class="chapter-item "><a href="developers/sdk/contract.html"><strong aria-hidden="true">1.3.4.</strong> Writing the Contract Binary</a></li><li class="chapter-item "><a href="developers/sdk/service.html"><strong aria-hidden="true">1.3.5.</strong> Writing the Service Binary</a></li><li class="chapter-item "><a href="developers/sdk/deploy.html"><strong aria-hidden="true">1.3.6.</strong> Deploying the Application</a></li><li class="chapter-item "><a href="developers/sdk/messages.html"><strong aria-hidden="true">1.3.7.</strong> Cross-Chain Messages</a></li><li class="chapter-item "><a href="developers/sdk/composition.html"><strong aria-hidden="true">1.3.8.</strong> Calling other Applications</a></li><li class="chapter-item "><a href="developers/sdk/blobs.html"><strong aria-hidden="true">1.3.9.</strong> Using Data Blobs</a></li><li class="chapter-item "><a href="developers/sdk/logging.html"><strong aria-hidden="true">1.3.10.</strong> Printing Logs from an Application</a></li><li class="chapter-item "><a href="developers/sdk/testing.html"><strong aria-hidden="true">1.3.11.</strong> Writing Tests</a></li></ol></li><li class="chapter-item "><a href="developers/advanced_topics.html"><strong aria-hidden="true">1.4.</strong> Advanced Topics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="developers/advanced_topics/contract_finalize.html"><strong aria-hidden="true">1.4.1.</strong> Contract Finalization</a></li><li class="chapter-item "><a href="developers/advanced_topics/validators.html"><strong aria-hidden="true">1.4.2.</strong> Validators</a></li><li class="chapter-item "><a href="developers/advanced_topics/block_creation.html"><strong aria-hidden="true">1.4.3.</strong> Creating New Blocks</a></li><li class="chapter-item "><a href="developers/advanced_topics/assets.html"><strong aria-hidden="true">1.4.4.</strong> Applications that Handle Assets</a></li></ol></li><li class="chapter-item "><a href="developers/experimental.html"><strong aria-hidden="true">1.5.</strong> Experimental</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="developers/experimental/ml.html"><strong aria-hidden="true">1.5.1.</strong> Machine Learning</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="operators.html"><strong aria-hidden="true">2.</strong> Node Operators</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="operators/devnets.html"><strong aria-hidden="true">2.1.</strong> Devnets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="operators/devnets/compose.html"><strong aria-hidden="true">2.1.1.</strong> Docker Compose</a></li><li class="chapter-item "><a href="operators/devnets/kind.html"><strong aria-hidden="true">2.1.2.</strong> kind</a></li></ol></li><li class="chapter-item "><a href="operators/testnets.html"><strong aria-hidden="true">2.2.</strong> Testnets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="operators/testnets/joining.html"><strong aria-hidden="true">2.2.1.</strong> Joining a Testnet</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="appendix.html"><strong aria-hidden="true">3.</strong> Appendix</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="appendix/glossary.html"><strong aria-hidden="true">3.1.</strong> Glossary</a></li><li class="chapter-item "><a href="appendix/videos.html"><strong aria-hidden="true">3.2.</strong> Videos</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/linera-io/linera-documentation" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/linera-io/linera-documentation/edit/main/src/developers/sdk/composition.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="calling-other-applications"><a class="header" href="#calling-other-applications">Calling other Applications</a></h1>
<p>We have seen that cross-chain messages sent by an application on one chain are
always handled by the <em>same</em> application on the target chain.</p>
<p>This section is about calling other applications using <em>cross-application
calls</em>.</p>
<p>Such calls happen on the same chain and are made with the
<a href="https://docs.rs/linera-sdk/latest/linera_sdk/contract/type.ContractRuntime.html#call_application"><code>ContractRuntime::call_application</code></a>
method:</p>
<pre><code class="language-rust ignore">pub fn call_application&lt;A: ContractAbi + Send&gt;(
    &amp;mut self,
    authenticated: bool,
    application: ApplicationId&lt;A&gt;,
    call: &amp;A::Operation,
) -&gt; A::Response {</code></pre>
<p>The <code>authenticated</code> argument specifies whether the callee is allowed to perform
actions that require authentication on behalf of the signer of the original
block that caused this call.</p>
<p>The <code>application</code> argument is the callee's application ID, and <code>A</code> is the
callee's ABI.</p>
<p>The <code>call</code> argument is the operation requested by the application call.</p>
<h2 id="example-crowd-funding"><a class="header" href="#example-crowd-funding">Example: Crowd-Funding</a></h2>
<p>The <code>crowd-funding</code> example application allows the application creator to launch
a campaign with a funding target. That target can be an amount specified in any
type of token based on the <code>fungible</code> application. Others can then pledge tokens
of that type to the campaign, and if the target is not reached by the deadline,
they are refunded.</p>
<p>If Alice used the <code>fungible</code> example to create a Pugecoin application (with an
impressionable pug as its mascot), then Bob can create a <code>crowd-funding</code>
application, use Pugecoin's application ID as <code>CrowdFundingAbi::Parameters</code>, and
specify in <code>CrowdFundingAbi::InstantiationArgument</code> that his campaign will run
for one week and has a target of 1000 Pugecoins.</p>
<p>Now let's say Carol wants to pledge 10 Pugecoin tokens to Bob's campaign.</p>
<p>First she needs to make sure she has his crowd-funding application on her chain,
e.g. using the <code>linera request-application</code> command. This will automatically
also register Alice's Pugecoin application on her chain, because it is a
dependency of Bob's.</p>
<p>Now she can make her pledge by running the <code>linera service</code> and making a query
to Bob's application:</p>
<pre><code class="language-json">mutation { pledge(owner: "User:841…6c0", amount: "10") }
</code></pre>
<p>This will add a block to Carol's chain containing the pledge operation that gets
handled by <code>CrowdFunding::execute_operation</code>, resulting in one cross-application
call and two cross-chain messages:</p>
<p>First <code>CrowdFunding::execute_operation</code> calls the <code>fungible</code> application on
Carol's chain to transfer 10 tokens to Carol's account on Bob's chain:</p>
<pre><code class="language-rust ignore">// ...
let call = fungible::Operation::Transfer {
    owner,
    amount,
    target_account,
};
// ...
self.runtime
    .call_application(/* authenticated by owner */ true, fungible_id, &amp;call);</code></pre>
<p>This causes <code>Fungible::execute_operation</code> to be run, which will create a
cross-chain message sending the amount 10 to the Pugecoin application instance
on Bob's chain.</p>
<p>After the cross-application call returns, <code>CrowdFunding::execute_operation</code>
continues to create another cross-chain message
<code>crowd_funding::Message::PledgeWithAccount</code>, which informs the crowd-funding
application on Bob's chain that the 10 tokens are meant for the campaign.</p>
<p>When Bob now adds a block to his chain that handles the two incoming messages,
first <code>Fungible::execute_message</code> gets executed, and then
<code>CrowdFunding::execute_message</code>. The latter makes another cross-application call
to transfer the 10 tokens from Carol's account to the crowd-funding
application's account (both on Bob's chain). That is successful because Carol
does now have 10 tokens on this chain and she authenticated the transfer
indirectly by signing her block. The crowd-funding application now makes a note
in its application state on Bob's chain that Carol has pledged 10 Pugecoin
tokens.</p>
<p>For the complete code please take a look at the
<a href="https://github.com/linera-io/linera-protocol/blob/f84b66720b92b2eab86622e26b56c3aa2adbc0c0/examples/crowd-funding/src/contract.rs"><code>crowd-funding</code></a>
and the
<a href="https://github.com/linera-io/linera-protocol/blob/f84b66720b92b2eab86622e26b56c3aa2adbc0c0/examples/fungible/src/contract.rs"><code>fungible</code></a>
application contracts in the <code>examples</code> folder in <code>linera-protocol</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../developers/sdk/messages.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../developers/sdk/blobs.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../developers/sdk/messages.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../developers/sdk/blobs.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../custom.js"></script>


    </div>
    </body>
</html>
