<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Design Patterns</title>


        <!-- Custom HTML head -->

        <meta name="description" content="The Linera Manual">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../../css/variables-d0866e17.css">
        <link rel="stylesheet" href="../../css/general-e9745eeb.css">
        <link rel="stylesheet" href="../../css/chrome-d7ced664.css">
        <link rel="stylesheet" href="../../css/print-ad67d350.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome-799aeb25.css">
        <link rel="stylesheet" href="../../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight-493f70e1.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight-56612340.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/theme-864c5258.css">
        <link rel="stylesheet" href="../.././mdbook-admonish.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc-2a6c6635.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const html = document.documentElement;
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/linera-io/linera-documentation" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/linera-io/linera-documentation/edit/main/src/developers/core_concepts/design_patterns.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="common-design-patterns"><a class="header" href="#common-design-patterns">Common Design Patterns</a></h1>
<p>We now explore some common design patterns to take advantage of microchains.</p>
<h2 id="applications-with-only-user-chains"><a class="header" href="#applications-with-only-user-chains">Applications with only user chains</a></h2>
<p>Some applications such as payments only require user chains, hence are fully
horizontally scalable:</p>
<pre class="mermaid">flowchart LR
    user1([&quot;user 1&quot;]) -- initiates transfer --&gt; chain1

    subgraph validators_only_users[&quot;Validators&quot;]
      chain1[&quot;user chain 1&quot;] -- &quot;sends assets&quot; --&gt; chain2[&quot;user chain 2&quot;]
    end

    chain2 -- notifies --&gt; user2([&quot;user 2&quot;])

    %% Styling
    style validators_only_users fill:#1A4456,stroke:#70D4D3,stroke-width:2px,stroke-dasharray:3 3,rx:10,ry:10
    style user1 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style user2 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style chain1 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain2 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px

</pre>
<h2 id="clientserver-applications"><a class="header" href="#clientserver-applications">Client/server applications</a></h2>
<p>Pre-existing applications (e.g. written in Solidity) generally run on a single
chain of blocks for all users. Those can be embedded in an app chain to act as a
service.</p>
<pre class="mermaid">flowchart LR
    user1([&quot;user 1&quot;]) -- initiates request --&gt; chain1
    user1 ~~~ chain1
    provider([&quot;block producer&quot;]) -- initiate response(s) --&gt; chain3
    chain1 -- notifies --&gt; user1
    chain3 -- notifies --&gt; provider

    subgraph validators_cs[&quot;Validators&quot;]
      chain1[&quot;user chain 1&quot;] -- &quot;sends request&quot; --&gt; chain3
      chain1 ~~~ chain3
      chain2[&quot;user chain 2&quot;] --&gt; chain3
      chain3[&quot;app chain&quot;] -- &quot;sends response&quot; --&gt; chain1
    end

    %% Styling
    style validators_cs fill:#1A4456,stroke:#70D4D3,stroke-width:2px,stroke-dasharray:3 3,rx:10,ry:10
    style user1 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style provider fill:#A0736B,stroke:#D2E8C8,stroke-width:2px
    style chain1 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain2 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain3 fill:#4A7B75,stroke:#70D4D3,stroke-width:2px

</pre>
<blockquote>
<p>Depending on the nature of the application, the blocks produced in the app
chain may be restricted to only contain messages (no operations). This is to
ensure that block producers have no influence on a chain, other than selecting
incoming messages.</p>
</blockquote>
<h2 id="using-personal-chains-to-scale-applications"><a class="header" href="#using-personal-chains-to-scale-applications">Using personal chains to scale applications</a></h2>
<p>User chains are useful to store the assets of their users and initiate requests
to app chains. Yet, oftentimes, they can also help applications scale
horizontally by taking work out of the app chains.</p>
<pre class="mermaid">flowchart LR
    user1([&quot;user 1&quot;]) -- submits ZK proof --&gt; chain1

    subgraph microchains_scale[&quot;Microchains&quot;]
      chain1[&quot;user chain 1&quot;]
      chain0[&quot;airdrop chain&quot;]
      chain1 -- &quot;sends trusted message《ZK proof is valid》&quot; --&gt; chain0
      chain1 ~~~ chain0
      chain0 -- &quot;sends tokens&quot; --&gt; chain1
      chain2[&quot;user chain 2&quot;] --&gt; chain0
    end

    %% Styling
    style microchains_scale fill:#1A4456,stroke:#70D4D3,stroke-width:2px,stroke-dasharray:3 3,rx:10,ry:10
    style user1 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style chain1 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain2 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain0 fill:#4A7B75,stroke:#70D4D3,stroke-width:2px

</pre>
<p>One of the benefits of personal chains is to enable transactions that would be
too slow or not deterministic enough for traditional blockchains, including:</p>
<ul>
<li>Validating ZK proofs,</li>
<li>Sending web queries to external oracle services (e.g. AI inference) and other
API providers,</li>
<li>Downloading data blobs from external data availability (”DA”) layers and
computing app-specific invariants.</li>
</ul>
<h2 id="using-temporary-chains-to-scale-applications"><a class="header" href="#using-temporary-chains-to-scale-applications">Using temporary chains to scale applications</a></h2>
<p>Temporary chains can be created on demand and configured to accept blocks from
specific users.</p>
<p>The following diagram allows a virtually unlimited number of games (e.g. chess
game) to be spawned for a given tournament.</p>
<pre class="mermaid">flowchart LR
    subgraph microchains_scale[&quot;Microchains&quot;]
      chain1[&quot;user chain 1&quot;] &lt;--&gt; chain3
      chain2[&quot;user chain 2&quot;] &lt;--&gt; chain3
      chain3[&quot;tournament app chain&quot;] -- creates --&gt; chain0[&quot;temporary game chain&quot;]
      chain0 -- reports result --&gt; chain3
    end

    user1([&quot;user 1&quot;]) -- request game --&gt; chain1
    user2([&quot;user 2&quot;]) -- request game --&gt; chain2
    user1 -- plays --&gt; chain0
    user2 -- plays --&gt; chain0

    %% Styling
    style microchains_scale fill:#1A4456,stroke:#70D4D3,stroke-width:2px,stroke-dasharray:3 3,rx:10,ry:10
    style user1 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style user2 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style chain1 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain2 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain3 fill:#4A7B75,stroke:#70D4D3,stroke-width:2px

</pre>
<h2 id="just-in-time-oracles"><a class="header" href="#just-in-time-oracles">Just-in-time oracles</a></h2>
<p>We have seen that Linera clients are connected and don’t rely on external RPC
providers to read on-chain data from the chain. This ability to receive secure,
censorship-resistant notifications and read data from the network is a game
changer allowing on-chain applications to query certain clients in real time.</p>
<p>For instance, clients may be running an AI oracle off-chain in a trusted
execution environment (TEE), allowing on-chain application to extract important
information form the Internet.</p>
<pre class="mermaid">flowchart LR
    subgraph validators_only_users[&quot;Validators&quot;]
      chain2 -- oracle response --&gt; chain1
      chain1[&quot;app chain&quot;] -- &quot;oracle query&quot; --&gt; chain2[&quot;oracle chain&quot;]
    end
    subgraph tee[&quot;Oracle TEE&quot;]
      user2([&quot;oracle client&quot;]) &lt;--&gt; ai[&quot;AI oracle&quot;]
    end
    chain2 -- notifies --&gt; user2
    user2 -- submit response --&gt; chain2
    ai &lt;--&gt; web((Web))

    %% Styling
    style validators_only_users fill:#1A4456,stroke:#70D4D3,stroke-width:2px,stroke-dasharray:3 3,rx:10,ry:10
    style tee fill:#1A4456,stroke:#A0E3E2,stroke-width:2px,stroke-dasharray:3 3,rx:10,ry:10
    style user2 fill:#8B7355,stroke:#EDE4D2,stroke-width:2px
    style ai fill:#A0736B,stroke:#D2E8C8,stroke-width:2px
    style chain1 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px
    style chain2 fill:#3A6B7A,stroke:#A0E3E2,stroke-width:2px

</pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../developers/core_concepts/applications.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../developers/backend.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../developers/core_concepts/applications.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../developers/backend.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../../mark-09e88c2c.min.js"></script>
        <script src="../../searcher-b074573a.js"></script>

        <script src="../../clipboard-1626706a.min.js"></script>
        <script src="../../highlight-abc7f01d.js"></script>
        <script src="../../book-ba43d0c1.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../custom-6e1704cf.js"></script>
        <script src="../../mermaid-eefea253.min.js"></script>
        <script src="../../mermaid-init-4a2716e5.js"></script>


    </div>
    </body>
</html>
