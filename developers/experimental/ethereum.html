<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ethereum</title>


        <!-- Custom HTML head -->

        <meta name="description" content="The Linera Manual">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../../css/variables-d0866e17.css">
        <link rel="stylesheet" href="../../css/general-e9745eeb.css">
        <link rel="stylesheet" href="../../css/chrome-d7ced664.css">
        <link rel="stylesheet" href="../../css/print-ad67d350.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome-799aeb25.css">
        <link rel="stylesheet" href="../../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight-493f70e1.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight-56612340.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/theme-864c5258.css">
        <link rel="stylesheet" href="../.././mdbook-admonish.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc-142e14bc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const html = document.documentElement;
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/linera-io/linera-documentation" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/linera-io/linera-documentation/edit/main/src/developers/experimental/ethereum.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="using-evm-based-smart-contracts-on-linera"><a class="header" href="#using-evm-based-smart-contracts-on-linera">Using EVM-Based Smart Contracts on Linera</a></h1>
<p>It is possible to use Ethereum Virtual Machine (EVM)-based smart contracts on
Linera. These contracts are typically written in Solidity.</p>
<p>EVM smart contracts have access Linera-specific functionality of Linera through
the <code>Linera.sol</code> library which exposes necessary interfaces for integration.</p>
<p>This allows smart contracts originally deployed on Ethereum to be migrated to
Linera and progressively adapted to Lineraâ€™s architecture and features.</p>
<h2 id="publishing-evm-smart-contracts"><a class="header" href="#publishing-evm-smart-contracts">Publishing EVM Smart Contracts</a></h2>
<p>The process for publishing EVM smart contracts is similar to that for Wasm smart
contracts, with the key difference being the need to specify the virtual machine
used (the default is Wasm).</p>
<p>For EVM contracts, there is only one bytecode file (unlike Wasm, which requires
separate <code>contract</code> and <code>service</code> binaries). Therefore, the same file must be
passed twice:</p>
<pre><code class="language-bash">linera publish-and-create \
  counter.bytecode counter.bytecode \
  --vm-runtime evm \
  --json-parameters "42"
</code></pre>
<p>Here, <code>counter.bytecode</code> contains the compiled contract, and "42" is passed as a
constructor argument via the <code>--json-parameters</code> flag.</p>
<p>Constructor arguments for the EVM contract are passed through application
parameters. Instantiation-specific arguments are provided separately.</p>
<h2 id="calling-other-smart-contracts"><a class="header" href="#calling-other-smart-contracts">Calling other smart contracts.</a></h2>
<p>EVM smart contracts on Linera can invoke other EVM contracts using standard
Solidity syntax.</p>
<h3 id="evm-contracts-calling-wasm-smart-contracts"><a class="header" href="#evm-contracts-calling-wasm-smart-contracts">EVM Contracts calling Wasm smart contracts.</a></h3>
<p>To call a Wasm smart contract from an EVM contract, use the following Solidity
command:</p>
<pre><code class="language-solidity">	bytes memory return_value = Linera.try_call_application(address, input);
</code></pre>
<ul>
<li><code>address</code>: the address of the Wasm smart contract, as a <code>bytes32</code>.</li>
<li><code>input</code>: the bytes representing the BCS-serialized <code>ContractAbi::Operation</code>
input.</li>
</ul>
<p>The serialization code can be generated using the <code>serde-reflection</code> crate.</p>
<h3 id="wasm-smart-contracts-calling-evm-contracts"><a class="header" href="#wasm-smart-contracts-calling-evm-contracts">Wasm Smart Contracts calling EVM Contracts.</a></h3>
<p>Wasm smart contracts can call EVM contracts using the <code>alloy-sol-types</code> crate.
This crate enables construction of Solidity-compatible types and supports RLP
serialization/deserialization.</p>
<p>The Wasm contract call-evm-counter demonstrates this functionality.</p>
<ul>
<li>
<p>For operations, the input type is <code>Vec&lt;u8&gt;</code>.</p>
</li>
<li>
<p>For service calls, the input type is <code>EvmQuery</code>.</p>
</li>
</ul>
<p>Note: Linera distinguishes between contract and service code execution contexts.</p>
<h2 id="multichain-evm-applications"><a class="header" href="#multichain-evm-applications">Multichain EVM applications.</a></h2>
<p>To operate across multiple chains, an EVM application must implement the
following functions:</p>
<pre><code class="language-solidity">    function instantiate(bytes memory input) external
    function execute_message(bytes memory input) external
</code></pre>
<ul>
<li>
<p><code>instantiate</code> is called on the creator chain.</p>
</li>
<li>
<p><code>execute_message</code> handles incoming cross-chain messages.</p>
</li>
</ul>
<p>Additional SDK functions available include:</p>
<pre><code class="language-solidity">    Linera.chain_ownership()
    Linera.read_data_blob()
    Linera.assert_data_blob_exists()
    Linera.validation_round()
    Linera.message_id()
    Linera.message_is_bouncing()
</code></pre>
<h2 id="difference-between-evm-applications-in-ethereum-and-linera"><a class="header" href="#difference-between-evm-applications-in-ethereum-and-linera">Difference between EVM applications in Ethereum and Linera.</a></h2>
<ul>
<li>
<p><code>Reentrancy</code>: Reentrancy is not supported on Linera. Contracts relying on it
will fail with a clean error.</p>
</li>
<li>
<p><code>Address Computation</code>: Contract addresses are computed differently from
Ethereum.</p>
</li>
<li>
<p><code>Gas Limits</code>: Following Infura's practice, Linera imposes a gas limit of
20,000,000 for service calls in EVM contracts. Contract execution is similarly
constrained.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../developers/experimental/ml.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../operators/devnets.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../developers/experimental/ml.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../operators/devnets.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../../mark-09e88c2c.min.js"></script>
        <script src="../../searcher-b074573a.js"></script>

        <script src="../../clipboard-1626706a.min.js"></script>
        <script src="../../highlight-abc7f01d.js"></script>
        <script src="../../book-ba43d0c1.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../custom-6e1704cf.js"></script>
        <script src="../../mermaid-eefea253.min.js"></script>
        <script src="../../mermaid-init-4a2716e5.js"></script>


    </div>
    </body>
</html>
